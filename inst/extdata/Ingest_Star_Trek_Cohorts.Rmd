---
title: "Ingest Star Trek Cohort"
author: '@MattjCamp'
date: "10/30/2016"
output: 
  html_document: 
    toc: yes
---

Set up libraries and the database that will hold the
cohort information.

```{r}

library(dbr)
library(readr)

db <- sqlite("test_scores.db")

```

# Read Data Into Database

All the data is stored in a csv files in the folder
**inst/extdata/fictional_charactors_cohort** that gets installed 
with this package.

## Read CSV Files into R

Read schools data:

```{r warning = FALSE} 

schools <- read_csv("fictional_charactors_cohort/Schools-Table 1.csv")

schools

```

Read exam data:

```{r warning = FALSE} 

exams <- read_csv("fictional_charactors_cohort/Exam-Table 1.csv")

exams

```

Read people data:

```{r warning = FALSE} 

people <- read_csv("fictional_charactors_cohort/People-Table 1.csv")

people

```

Read cohort data:

```{r warning = FALSE} 

cohorts <- read_csv("fictional_charactors_cohort/Cohort-Table 1.csv")

cohorts

```

## Clean Data

Most of the imported data had extra rows and columns and
I want to get rid of these before importing into the database.

Clean `schools`:

```{r warning = FALSE} 

schools <- schools[1:8, 1:4]

schools

```

Clean `exams`:

```{r warning = FALSE} 

exams <- exams[1, 1:3]

exams

```

I didn't really need to clean `people`:

```{r warning = FALSE} 

people

```

Clean `cohorts`:

```{r warning = FALSE} 

cohorts <- cohorts[, 1:2]

cohorts

```

## Import Data into Database

Here is where I import the data into the 
database named **test_scores.db**.

```{r warning = FALSE} 

db$drop("cohorts")
db$save(df = cohorts, tablename = "cohorts")
db$drop("exams")
db$save(df = exams, tablename = "exams")
db$drop("people")
db$save(df = people, tablename = "people")
db$drop("schools")
db$save(df = schools, tablename = "schools")

```

Verify that the tables ended up in the database:

```{r warning = FALSE} 

db$tables()

```
